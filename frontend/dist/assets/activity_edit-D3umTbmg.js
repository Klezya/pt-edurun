import{c as h,d as M,r as c,o as B,q as D,a as v,b as e,p as k,t as f,i as b,k as $,e as E,y as N,s as _,z as j,u as S,f as p,_ as U}from"./index-BeI-SkGy.js";import{b as V}from"./index-DP5mw_I0.js";import{c as C,p as L,o as P}from"./index-UlJKtRD1.js";import{b as q,a as H}from"./activitys.service-Ot-Rr1o1.js";async function A(r,s){console.log("Actualizando evaluaci贸n:",r,s);const l=await fetch(`${h.apiBaseUrl}/api/evaluacion/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!l.ok){const a=await l.json().catch(()=>({detail:"Error al actualizar la evaluaci贸n"}));throw new Error(a.detail||"Error al actualizar la evaluaci贸n")}return l.json()}async function I(r,s){console.log("Actualizando tarea:",r,s);const l=await fetch(`${h.apiBaseUrl}/api/tarea/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!l.ok){const a=await l.json().catch(()=>({detail:"Error al actualizar la tarea"}));throw new Error(a.detail||"Error al actualizar la tarea")}return l.json()}async function G(r){const s=await fetch(`${h.apiBaseUrl}/api/evaluacion/${r}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!s.ok){const l=await s.json().catch(()=>({detail:"Error al eliminar la evaluaci贸n"}));throw new Error(l.detail||"Error al eliminar la evaluaci贸n")}return s.json()}async function J(r){const s=await fetch(`${h.apiBaseUrl}/api/tarea/${r}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!s.ok){const l=await s.json().catch(()=>({detail:"Error al eliminar la tarea"}));throw new Error(l.detail||"Error al eliminar la tarea")}return s.json()}const O={class:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900"},R={class:"relative flex min-h-screen flex-col"},F={class:"border-b border-white/10 bg-slate-950/30 backdrop-blur-sm shadow-lg"},K={class:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},Q={class:"flex h-20 items-center justify-between"},W={class:"flex items-center gap-3"},X={class:"text-2xl font-bold bg-gradient-to-r from-sky-400 to-blue-500 bg-clip-text text-transparent"},Y={class:"flex flex-grow items-start justify-center px-4 py-8"},Z={class:"mx-auto max-w-7xl w-full"},ee={key:0,class:"rounded-2xl border border-white/10 bg-slate-950/40 backdrop-blur-md shadow-2xl overflow-hidden"},te={key:1},ae={key:0,class:"mb-6 rounded-xl border border-green-500/20 bg-green-950/40 backdrop-blur-md p-4"},oe={class:"flex items-center gap-3"},se={class:"text-green-200 font-medium"},le={key:1,class:"mb-6 rounded-xl border border-red-500/20 bg-red-950/40 backdrop-blur-md p-4"},re={class:"flex items-center gap-3"},ie={class:"text-red-200 font-medium"},ne={class:"rounded-2xl border border-white/10 bg-slate-950/40 backdrop-blur-md shadow-2xl overflow-hidden"},de={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ue={class:"space-y-6"},ce={class:"space-y-2"},ve={class:"flex items-center gap-4 p-4 rounded-lg bg-slate-900/50 border border-white/10"},pe={class:"space-y-2"},me={class:"space-y-2"},fe={class:"space-y-4"},be={class:"space-y-3"},he={class:"flex items-center justify-between gap-4 pt-8 mt-8 border-t border-white/10"},xe={class:"flex items-center gap-4"},ge=["disabled"],we={class:"flex items-center gap-4"},ye=["disabled"],ke={key:0,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ee={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_e=M({__name:"activity_edit",setup(r){const s=S(),l=D(),a=c({titulo:"",contenido:"",test:"",tipo:"tarea"}),d=c(!1),x=c(!0),i=c(""),u=c(""),n=c(0),g=c(null);let m=null;B(async()=>{try{if(n.value=Number(l.params.id),a.value.tipo=l.params.tipo,isNaN(n.value)){i.value="ID de actividad inv谩lido",x.value=!1;return}let o;a.value.tipo==="evaluacion"?o=await q(n.value):o=await H(n.value),a.value.titulo=o.titulo,a.value.contenido=o.contenido,a.value.test=o.test||""}catch(o){console.error("Error al cargar la actividad:",o),i.value="Error al cargar los datos de la actividad"}finally{x.value=!1,await new Promise(o=>setTimeout(o,100)),g.value&&!i.value&&(m=new C({doc:a.value.test||"",extensions:[V,L(),P,C.updateListener.of(o=>{o.docChanged&&(a.value.test=o.state.doc.toString())})],parent:g.value}))}});const T=async()=>{if(i.value="",u.value="",!a.value.titulo||!a.value.contenido){i.value="Por favor complete todos los campos obligatorios";return}d.value=!0;try{const o={titulo:a.value.titulo,contenido:a.value.contenido,test:a.value.test||null};a.value.tipo==="evaluacion"?(await A(n.value,o),u.value="Evaluaci贸n actualizada exitosamente"):(await I(n.value,o),u.value="Tarea actualizada exitosamente"),setTimeout(()=>{w()},2e3)}catch(o){console.error("Error al actualizar:",o),i.value=o instanceof Error?o.message:`Error al actualizar la ${a.value.tipo}`}finally{d.value=!1}},w=()=>{m&&m.destroy(),s.push({name:"actividad-detalles",params:{id:n.value,tipo:a.value.tipo}})},z=async()=>{if(i.value="",u.value="",!!window.confirm("驴Est谩s seguro de que deseas eliminar esta actividad? Esta acci贸n no se puede deshacer.")){d.value=!0;try{a.value.tipo==="evaluacion"?(await G(n.value),u.value="Evaluaci贸n eliminada exitosamente"):(await J(n.value),u.value="Tarea eliminada exitosamente"),m&&m.destroy(),setTimeout(()=>{s.push({name:"actividades-docente"})},1200)}catch(t){console.error("Error al eliminar:",t),i.value=t instanceof Error?t.message:`Error al eliminar la ${a.value.tipo}`}finally{d.value=!1}}};return(o,t)=>(p(),v("div",O,[t[19]||(t[19]=e("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[e("div",{class:"absolute top-20 left-10 w-72 h-72 bg-sky-500/10 rounded-full blur-3xl"}),e("div",{class:"absolute bottom-20 right-10 w-96 h-96 bg-purple-500/10 rounded-full blur-3xl"})],-1)),e("div",R,[e("header",F,[e("div",K,[e("div",Q,[e("div",W,[e("div",{class:k(["p-2 rounded-xl shadow-lg",a.value.tipo==="evaluacion"?"bg-gradient-to-br from-purple-400 to-blue-600":"bg-gradient-to-br from-emerald-400 to-teal-600"])},t[2]||(t[2]=[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),2),e("div",null,[e("h1",X," Editar "+f(a.value.tipo==="evaluacion"?"Evaluaci贸n":"Tarea"),1),t[3]||(t[3]=e("p",{class:"text-sm text-slate-400"},"Modifica los datos de la actividad",-1))])]),e("div",{class:"flex items-center gap-3"},[e("button",{onClick:w,class:"inline-flex items-center gap-2 rounded-lg px-4 py-2.5 text-sm font-medium text-slate-200 hover:bg-white/10 hover:text-white transition-all duration-200 hover:scale-105"},t[4]||(t[4]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),b(" Cancelar ",-1)]))])])])]),e("main",Y,[e("div",Z,[x.value?(p(),v("div",ee,t[5]||(t[5]=[$('<div class="p-8" data-v-fede4ae3><div class="animate-pulse space-y-6" data-v-fede4ae3><div class="h-8 w-2/3 rounded bg-slate-700/50" data-v-fede4ae3></div><div class="h-4 w-40 rounded bg-slate-800/50" data-v-fede4ae3></div><div class="space-y-3" data-v-fede4ae3><div class="h-10 w-full rounded bg-slate-800/50" data-v-fede4ae3></div><div class="h-32 w-full rounded bg-slate-800/50" data-v-fede4ae3></div><div class="h-64 w-full rounded bg-slate-800/50" data-v-fede4ae3></div></div></div></div>',1)]))):(p(),v("div",te,[u.value?(p(),v("div",ae,[e("div",oe,[t[6]||(t[6]=e("svg",{class:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",se,f(u.value),1)])])):E("",!0),i.value?(p(),v("div",le,[e("div",re,[t[7]||(t[7]=e("svg",{class:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",ie,f(i.value),1)])])):E("",!0),e("div",ne,[e("form",{onSubmit:N(T,["prevent"]),class:"p-8"},[e("div",de,[e("div",ue,[t[12]||(t[12]=e("h2",{class:"text-xl font-semibold text-slate-100 border-b border-white/10 pb-3"}," Informaci贸n General ",-1)),e("div",ce,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-slate-200"}," Tipo de Actividad ",-1)),e("div",ve,[e("div",{class:k(["flex-1 px-4 py-3 rounded-lg font-medium text-center",a.value.tipo==="tarea"?"bg-gradient-to-r from-emerald-500 to-teal-600 text-white shadow-lg":a.value.tipo==="evaluacion"?"bg-gradient-to-r from-purple-500 to-blue-600 text-white shadow-lg":"bg-slate-800/50 text-slate-400"])},f(a.value.tipo==="tarea"?" Tarea":" Evaluaci贸n"),3)]),t[9]||(t[9]=e("p",{class:"text-xs text-slate-500"},"El tipo de actividad no puede ser modificado",-1))]),e("div",pe,[t[10]||(t[10]=e("label",{for:"titulo",class:"block text-sm font-medium text-slate-200"},[b(" T铆tulo "),e("span",{class:"text-red-400"},"*")],-1)),_(e("input",{id:"titulo","onUpdate:modelValue":t[0]||(t[0]=y=>a.value.titulo=y),type:"text",required:"",placeholder:"Ingrese el t铆tulo",class:"w-full rounded-lg border border-white/10 bg-slate-900/50 px-4 py-3 text-slate-100 placeholder:text-slate-500 focus:border-sky-500/50 focus:outline-none focus:ring-2 focus:ring-sky-500/20 transition-all"},null,512),[[j,a.value.titulo]])]),e("div",me,[t[11]||(t[11]=e("label",{for:"contenido",class:"block text-sm font-medium text-slate-200"},[b(" Descripci贸n "),e("span",{class:"text-red-400"},"*")],-1)),_(e("textarea",{id:"contenido","onUpdate:modelValue":t[1]||(t[1]=y=>a.value.contenido=y),rows:"8",required:"",placeholder:"Ingrese la descripci贸n y detalles de la actividad",class:"w-full rounded-lg border border-white/10 bg-slate-900/50 px-4 py-3 text-slate-100 placeholder:text-slate-500 focus:border-sky-500/50 focus:outline-none focus:ring-2 focus:ring-sky-500/20 transition-all resize-vertical"},null,512),[[j,a.value.contenido]])])]),e("div",fe,[t[14]||(t[14]=e("div",{class:"flex items-center justify-between border-b border-white/10 pb-3"},[e("h2",{class:"text-xl font-semibold text-slate-100"}," C贸digo de Prueba (Pytest) "),e("span",{class:"text-slate-500 text-xs"},"(opcional)")],-1)),e("div",be,[t[13]||(t[13]=e("p",{class:"text-slate-400 text-sm flex items-start gap-2"},[e("svg",{class:"w-4 h-4 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",null," Escriba el c贸digo de prueba Pytest que se ejecutar谩 para evaluar las entregas de los estudiantes. Deje vac铆o si no requiere pruebas automatizadas. ")],-1)),e("div",{ref_key:"editorContainer",ref:g,class:"rounded-lg border border-white/10 overflow-hidden shadow-lg",style:{height:"500px"}},null,512)])])]),e("div",he,[e("div",xe,[e("button",{type:"button",onClick:z,disabled:d.value,class:"rounded-lg px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed"},t[15]||(t[15]=[e("svg",{class:"w-4 h-4 inline-block mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6M1 7h22M10 3h4l1 4H9l1-4z"})],-1),b(" Eliminar ",-1)]),8,ge)]),e("div",we,[e("button",{type:"button",onClick:w,class:"rounded-lg px-6 py-3 text-sm font-medium text-slate-200 hover:bg-white/10 transition-all duration-200 hover:scale-105"}," Cancelar "),e("button",{type:"submit",disabled:d.value,class:k(["inline-flex items-center gap-2 rounded-lg px-6 py-3 text-sm font-medium text-white shadow-lg transition-all duration-200 hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",a.value.tipo==="evaluacion"?"bg-gradient-to-r from-purple-500 to-blue-600 hover:shadow-purple-500/50 shadow-purple-500/30":"bg-gradient-to-r from-emerald-500 to-teal-600 hover:shadow-emerald-500/50 shadow-emerald-500/30"])},[d.value?(p(),v("svg",ke,t[16]||(t[16]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]))):(p(),v("svg",Ee,t[17]||(t[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))),b(" "+f(d.value?"Guardando...":"Guardar Cambios"),1)],10,ye)])])],32)])]))])]),t[18]||(t[18]=e("footer",{class:"border-t border-white/10 bg-slate-950/30 backdrop-blur-sm"},[e("div",{class:"mx-auto max-w-7xl px-4 py-8"},[e("div",{class:"flex flex-col md:flex-row items-center justify-between gap-4"},[e("p",{class:"text-sm text-slate-400"}," 漏 2025 Edurun. Todos los derechos reservados. ")])])],-1))])]))}}),Me=U(_e,[["__scopeId","data-v-fede4ae3"]]);export{Me as default};
